# 针对复杂问题的建模与仿真实验
## 问题描述
>SM实验室测试设施

SM检测是一系列小型医学实验室检测设备的母公司。这些设施通常位于医院或诊所内或附近。其中许多是新的，是医学界采取削减成本措施的直接结果。在许多情况下，医院或诊所将他们的检测工作交给外部承包商，但在自己的设施内为所需的实验室提供空间。

SM测试提供各种各样的测试服务，并有长期计划增加我们在这个新兴市场的存在。最近，我们专注于一种特定类型的测试实验室，并进行了一个大型项目，使大多数这些设施实现自动化。一些试点设施已经建成，证明不仅在提供所需服务方面有效，而且在盈利方面也有效。目前，我们无法根据特定的站点需求适当地调整自动化系统的大小，这是大规模提供此类服务的障碍。虽然为试点项目开发了一种方法，但大大低估了所需系统的规模。因此，当发现容量问题时，需要额外的设备。尽管这种试错方法最终提供了能够满足客户需求的系统，但它不是大规模引入这些自动化系统的可接受方法。从系统最初安装到最终能够满足客户需求所用的时间从8个月到14个月不等。在此期间，人工测试补充了自动化系统的能力。这证明是非常昂贵的。

很明显，我们可以故意加大系统的尺寸，以始终满足预计的客户需求，但可以理解的是，始终满足需求的设计可能会导致非常昂贵的系统，同时降低盈利能力。我们希望能够轻松地调整这些系统的大小，以满足或超过客户的要求，同时将我们的投资保持在最低水平。我们已经探讨了解决这个问题的几种方法，并得出结论，计算机模拟可以很好地提供必要的技术，以适当地调整这些系统的大小。

在发布此建议请求之前，我们的工程人员开发了一个标准物理配置，将用于所有未来的系统。此标准配置的示意图如下所示。

标准配置包括连接六个不同主要位置的运输环路或赛道：一个装卸区和五个不同的测试单元。每个测试单元将包含一个或多个执行特定于该单元的测试的自动化测试设备。加载/卸载区域提供了将新样本输入系统和从系统中删除已完成样本的方法。运输环路或赛道可以可视化为斗式输送机或简单的动力和自由输送机。样品通过系统在特殊的样品架上运输，可以认为是小托盘或手推车，用来存放样品。样本架的数量取决于各个系统。
运输环路是48英尺长，它可以容纳最多48个样本架，间隔在1英尺增量。请注意，由于样本架也可以在测试单元或加载/卸载区域内，因此样本架的总数可以超过48个。在加载/卸载区域和每个测试单元的“进入”和“退出”点之间的距离为3英尺。一个单元的“出口”点与下一个CEL的“进入”点之间的距离是5英尺。
 
![Image text](https://github.com/ianygao/smLab/raw/master/image/sm1.png)

让我们来看看典型样本在系统中的运动。到达实验室的样品最初要为自动化系统进行人工制备。然后将样本放入加载/卸载区域的输入队列中。这种手动准备通常需要大约5分钟。当样本到达队列的前面时，它将一直等到空的样本架可用为止。此时，样品自动加载到样品架上，装置（样品架上的样品）进入运输回路。一个单位进入交通环线的过程很像一辆汽车从入口匝道进入高速公路。一旦有空位可用，这个单元（或汽车）就会融入交通流中。运输回路以每秒1英尺的恒定速度逆时针移动装置。不允许超车。

每个样本都是条形码，其中包含对患者文件的引用以及需要执行的测试序列。样本将遵循特定的顺序。例如，一个序列要求样本访问测试单元5-3-1（按该顺序）。让我们跟随其中一个样本和样本架（单元）完成整个序列。它在标记为“出口”的位置上离开负载/卸载，并逆时针方向移动经过测试单元1到4，直到它到达测试单元5的“进入”点。当装置在系统中移动时，在一系列点读取条形码，以便系统自动将装置引导到正确的区域。当它到达测试单元5时，系统检查当前有多少单元在测试单元5等待测试。无论单元中的测试机数量多少，测试机面前只有3个单元的容量。5个测试单元的容量相同。容量（3）不包括当前正在测试的任何单元或已完成测试并等待并入运输回路的单元。如果没有可用的空间，单元将继续移动并形成一个完整的循环，直到它返回到所需的单元格。如果容量或空间可用，单元将自动转移到单元中（很像从高速公路退出）。合并或退出循环的时间是可以忽略不计的。典型测试单元的示意图如下所示。
 
一旦测试机可用，就对单元进行测试，记录结果，单元尝试合并回循环。接下来，它将移动到测试单元3的“Enter”点，在这里应用与测试单元5相同的逻辑。一旦测试完成，它将被引导到测试单元1进行最后一次测试。当测试序列中的所有步骤都完成时，单元被引导到卸载区域的“输入”点。

设计了数据采集系统，用以检验各项测试的统计有效性。在样品离开检测仪之前，不执行此检查。如果测试结果未达到可接受的统计标准，则立即将样本送回进行第二次测试。

尽管在每个测试单元上可以有不同数量的测试机，但是在加载/卸载区域只有一个设备。此区域提供两个功能：新到样品的加载和已完成样品的卸载。此区域的当前系统逻辑试图确保新到达的样本不必等待样本架。因此，当循环中的样本架接近该区域的“Enter”点时，系统将检查holder是否为空，或者是否包含已完成其序列的样本。如果检查满足上述任一条件，则系统将检查样品架在装载/卸载区域是否有空间。该区域可容纳5个样品架，不包括装载/卸载设备上的样品架或任何等待并入回路的样品架。如果有空间，样品架进入该区域。加载/卸载区域的示意图如下所示。
 
只要在装卸装置前有样品架，它就会继续工作或循环。只有在没有可用的样本架进行处理时，它才会停止或暂停。该装置的具体动作取决于样品架的状态和新样品的可用性。有四种可能的行动。

1.样本架为空，新样本队列为空。在这种情况下，不需要任何操作，样本架被发送回循环。

2.样品架为空，新样品待处理。在这种情况下，新的样本被加载到样本架上并发送到循环。

3.样本架包含一个已完成的样本，新样本队列为空。在这种情况下，将卸载完成的样本，并将空样本架发送回系统。

4.样品架包含一个完成的样品，新样品待处理。在这种情况下，将卸载完成的样本，并将新样本加载到样本架上并发送到循环。

设备的循环时间取决于许多不同的因素，但我们的工作人员进行了分析，得出结论：循环时间遵循三角形分布，参数为0.18、0.23和0.45（分钟）。从样品架上卸下样品之前，不认为样品是（测试）完成的。届时，系统将从数据库中收集结果，并将其转发给请求测试的个人或地区。

单个测试的时间是恒定的，但取决于测试单元。这些循环时间如下所示。
Tester	Cycle Time 
(minutes)
1	0.77
2	0.85
3	1.03
4	1.24
5	1.7

在测试仪3执行的每个测试需要1.6盎司的试剂，而38%在测试仪4执行的测试需要0.6盎司的不同试剂。这些是标准试剂，会自动输入测试仪。

测试机定期故障或需要清洁。我们的工作人员已经收集了关于这些活动的数据，以下是四位测试机的数据。平均无故障时间（MTBF）单位为小时，平均修复时间（MTR）单位为分钟。
Tester	MTBF MUT 
(hours)	MTR 
(minutes)
1	14	11
3	9	7
4	15	14
5	16	13

测试单元2的测试机很少失败，但它们确实需要在执行300次测试后进行清洁。清洁时间遵循参数为5.0、6.0、10.0（分钟）的三角形分布。

下一个试验实验室将每周7天，每天24小时开放。我们的工作人员预测了该网站的需求数据，如下所示。小时1表示午夜到凌晨1点之间的时间。24小时表示从晚上11点到午夜之间的时间。rate以每小时平均到达个数表示。样品以这样的速度全天不间断地到达。
Hour	Rate	Hour	Rate	Hour	Rate
1	119	9	131	17	134
2	107	10	152	18	147
3	100	11	171	19	165
4	113	12	191	20	155
5	123	13	200	21	149
6	116	14	178	22	134
7	107	15	171	23	119
8	121	16	152	24	116









每个到达的样本都需要一系列特定的测试，总是按照列出的顺序进行。有九个可能的测试序列，数据如下。
Sequence #	Sequence Steps	Percentage (%)
1	1-2-4-5	9
2	3-4-5	13
3	1-2-3-4	15
4	4-3-2	12
5	2-5- 1	7
6	4-5-2-3	11
7	1-5-3-4	14
8	5-3-1	6
9	2-4-5	13

我们的合同通常要求我们在收到样品后一小时内提供测试结果。对于这个试点，我们还需要容纳“Rush”样品，我们必须在30分钟内提供测试结果。据估计，7%的进货样品将贴上“Rush”标签，这些“Rush”样品在装货区优先。

我们要求并收到了设备制造商的成本数据。这些成本包括每台机组预计寿命的初始资本、运行和维护成本。下面给出的费用是每个单位每月的费用。
Equipment	Cost per month ($)
Tester Type 1	10,000
Tester Type 2	12,400
Tester Type 3	8,5000
Tester Type 4	9,800
Tester Type 5	11,200
Sample holder	387
从这项模拟研究中，我们想知道什么样的配置可以在获得高客户满意度的同时提供最具成本效益的解决方案。理想情况下，我们总是希望在少于合同要求的时间内提供结果。然而，我们也不认为该系统应该包括额外的设备，只是为了处理罕见的迟交报告。

在最近的SM测试会议上，提交了一份关于先前试验系统观察结果的报告。报告指出，当系统轻载时，已完成的样品难以进入装载/卸载区域。这通常会导致完成的样本在最终能够退出之前进行多次循环。有人担心，超过必要的测试时间可能会导致系统配置多余的设备。

考虑到这一点，我们已经联系了我们的设备供应商，并要求报价，以便仅在装卸区域的出口点实施备用逻辑。建议优先考虑退出循环的已完成样本。当循环中的样本架到达该区域的“Enter”点时，系统将检查holder是否为空或是否包含已完成其序列的样本。如果样品架包含一个完成的样品，并且在装载/卸载时有空间，它将离开回路并进入该区域。如果样本架是空的，它会检查有多少样本架在该区域等待。如果这个数字小于某个建议的数字，例如2，则样本架离开环并进入该区域。否则，它将继续循环。这个想法总是试图保持一个样品架可用于一个新的样品，而不是填补空的样品架区域。供应商设备同意提供这种新逻辑，一次性费用为8.5万美元。作为您建议的一部分，我们希望您评估这个新逻辑，包括确定建议的数字的最佳值。

您的报告应该包括一个最具成本效益的系统配置建议。这应该包括每个单元的测试机数量、样本架的数量，以及对建议逻辑的决定。请按每月提供所有成本估算。

我们目前正在进行这一新设施的建设，两个月后才需要解决方案。由于有几个集团在竞争这项合同，我们决定在分析期间不提供额外的信息。但是，我们鼓励您做出其他合理的、有文档记录的假设。我们期待着及时收到您的报告，并审查您提出的解决方案。

